<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>React-Tomato</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.8/react.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.8/react-dom.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.6.16/browser.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.2/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.5/marked.min.js"></script>
</head>
<body>
  <div id="countdown"></div>
  <script type="text/babel">

  var SetIntervalMixin = {
    componentWillMount: function() {
      this.intervals = [];
    },
    setInterval: function() {
      this.intervals.push(setInterval.apply(null, arguments));
    },
    componentWillUnmount: function() {
      this.intervals.forEach(clearInterval);
    }
  };

  var Countdown = React.createClass({
    mixins: [SetIntervalMixin], 
    getInitialState: function() {
      return {seconds: 15};
    },
    componentDidMount: function() {
      this.setInterval(this.tick, 1000);
    },
    tick: function() {
      this.setState({seconds: this.state.seconds - 1});
    },
    render: function() {
      if (this.state.seconds > 0) {
        return (
          <p>Countdown {this.state.seconds} seconds</p>
          );
      } else {
        return (
          <p>Pomodoro finished</p>
          );
      }
    }
  });


  ReactDOM.render(
    <Countdown />,
    document.getElementById('countdown')
    );
  </script>
</body>
</html>
